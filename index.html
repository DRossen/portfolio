<!DOCTYPE HTML>
<html lang="en">

<head>
  <title>TestHemsida</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light only" />
  <meta name="description" content="TestHemsida" />
  <meta property="og:site_name" content="TestHemsida" />
  <meta property="og:title" content="TestHemsida" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="TestHemsida" />
  <meta property="og:image" content="https://danielrosentest.carrd.co/assets/images/card.jpg?v=d795e2df" />
  <meta property="og:image:type" content="image/jpeg" />
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="800" />
  <meta property="og:url" content="https://danielrosentest.carrd.co" />
  <meta property="twitter:card" content="summary_large_image" />
  <link rel="canonical" href="https://danielrosentest.carrd.co" />

  <!-- Your main styles -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Dracula theme for syntax highlighting -->
  <link rel="stylesheet" href="dracula.css" />

  <script>
    const interestTemplate = `
void InfluenceManager::InitTemplate(const int aSize, FalloffFunction aFallofCurve, InterestTemplate& aTemplate)
{
	int dimension = (aSize * 2);
	dimension = dimension % 2 != 0 ? dimension : dimension + 1;
	aTemplate.dimensions = dimension;
	aTemplate.values.resize(dimension * dimension);
	aTemplate.centerCell = { dimension / 2, dimension / 2 };
	int index = 0;
	for (int row = 0; row < dimension; row++)
	{
		for (int col = 0; col < dimension; col++)
		{
			int coordDistance = (Vector2i(col, row) - aTemplate.centerCell).LengthSqr();
			float distance = sqrt(static_cast<float>(coordDistance)) * myCellSize;
			float interest = aFallofCurve(distance, static_cast<float>(aSize));
			aTemplate.values[index] = interest;
			index++;
		}
	}
}
    `;

    const workmap = `
Workmap* workmap = influenceManager->GetWorkmap(scanCenterPosition, scanRadius);
workmap->Add(Team::Player, InfluenceType::Proximity, -1.0);
workmap->ExcludeUserInfluence(user, InfluenceType::Proximity);
workmap->Add(Team::Enemy, InfluenceType::Proximity, 2.0);

Vector3f result;
if (workmap->GetPositionByHighestValue(result)) {
highestThreatPosition = result;
}
    `;
    const floodfill = `
void InfluenceMap::FloodFillInfluence(const Vector2i& aOriginCoord, const InfluenceData& aInfluenceData, float aAmount)
{
	InterestTemplate& interestTemplate = myManager->GetImprintTemplate(aInfluenceData);
	FalloffFunction curveFunc = GetFalloffFunction(aInfluenceData.type);
	int radius = interestTemplate.dimensions / 2;
	int maxIterations = radius + 1;
	std::set<int> visited;
	std::queue<std::tuple<Vector2i, Vector2i, int>> bfsQueue;
	Vector2i boundsMin = { std::max(myBoundsMin.x, aOriginCoord.x - radius), std::max(myBoundsMin.y, aOriginCoord.y - radius) };
	Vector2i boundsMax = { std::min(myBoundsMax.x, aOriginCoord.x + radius), std::min(myBoundsMax.y, aOriginCoord.y + radius) };
	bfsQueue.push({ aOriginCoord, interestTemplate.centerCell, 1 });
	int worldStartIndex = aOriginCoord.y * myGridSize.x + aOriginCoord.x;
	int localStartIndex = interestTemplate.centerCell.y * interestTemplate.dimensions + interestTemplate.centerCell.x;
	if (worldStartIndex >= 0 && worldStartIndex < myValues.size())
	{
		myValues[worldStartIndex] += interestTemplate.values[localStartIndex] * aAmount;
		visited.insert(worldStartIndex);
	}
	float bfsFallof = 1.0f;
	int distance = 1;
	int iteration = 1;
	while (!bfsQueue.empty())
	{
		Vector2i nextLocalCoord, nextTemplateCoord;
		Vector2i localCoord, templateCoord;
		std::tie(localCoord, templateCoord, distance) = bfsQueue.front();
		bfsQueue.pop();
		bfsFallof = curveFunc(static_cast<float>(distance), static_cast<float>(maxIterations));
		for (const auto& direction : directions)
		{
			nextLocalCoord = localCoord + direction;
			nextTemplateCoord = templateCoord + direction;
			if (nextLocalCoord.x < boundsMin.x || nextLocalCoord.x > boundsMax.x ||
				nextLocalCoord.y < boundsMin.y || nextLocalCoord.y > boundsMax.y) {
				continue;
			}
			int heatmapIndex = nextLocalCoord.y * myGridSize.x + nextLocalCoord.x;
			int templateIndex = nextTemplateCoord.y * interestTemplate.dimensions + nextTemplateCoord.x;
			if (!myValidCells->at(heatmapIndex)) continue;
			if (visited.find(heatmapIndex) == visited.end())
			{
				myValues[heatmapIndex] += (interestTemplate.values[templateIndex] * bfsFallof) * aAmount;
				bfsQueue.push({ nextLocalCoord, nextTemplateCoord, distance + 1 });
				visited.insert(heatmapIndex);
			}
		}
	}
}
    `;

    // Function to inject code into the page and apply syntax highlighting
    function injectCode(code, elementId) {
      const element = document.getElementById(elementId);
      element.innerHTML = code;  // Inject as HTML (not plain text)
      // Re-apply syntax highlighting after the content is injected
      hljs.highlightElement(element); // highlight the specific element
    }

    // Is being called when the page loads.
    // Which injects the code snippets into placed where we added them (by id, "grid-code" for example )
    window.onload = function () {
      injectCode(interestTemplate, "interest-template");
      injectCode(workmap, "work-map");
      injectCode(floodfill, "flood-fill");
    };
  </script>
</head>

<body><svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink"
    viewBox="0 0 40 40" display="none" width="0" height="0">
    <symbol id="icon-added293106ea616175452e6eb0197f0" viewBox="0 0 40 40">
      <path
        d="M31.6,36.5H8.4c-1.7,0-3.1-1.4-3.1-3.1v-4.6c0-3.8,1.8-6.9,5.2-9c1.1-0.7,2.4-1.2,3.8-1.6 c-0.8-0.7-1.5-1.5-2-2.4c-0.8-1.3-1.2-2.9-1.2-4.4c0-4.9,4-8.9,8.9-8.9s8.9,4,8.9,8.9c0,1.6-0.4,3.1-1.2,4.4c-0.5,0.9-1.2,1.7-2,2.4 c1.4,0.4,2.7,1,3.8,1.6c3.4,2,5.2,5.1,5.2,9v4.6C34.7,35.1,33.3,36.5,31.6,36.5z" />
    </symbol>
    <symbol id="icon-5569d30d08dca4cfb60d1e85346b6cde" viewBox="0 0 40 40">
      <path
        d="M0.7,17c0.5-0.5,1-0.7,1.7-0.7h13.8l-5.8-5.8C9.9,10,9.7,9.4,9.7,8.7s0.2-1.3,0.7-1.8l1.5-1.5c0.5-0.5,1.1-0.7,1.8-0.7 c0.7,0,1.3,0.2,1.8,0.7l12.7,12.8c0.5,0.5,0.7,1.1,0.7,1.8c0,0.7-0.2,1.3-0.7,1.8L15.5,34.6c-0.5,0.5-1.1,0.7-1.8,0.7 c-0.7,0-1.3-0.2-1.8-0.7l-1.5-1.5c-0.5-0.5-0.7-1.1-0.7-1.8c0-0.7,0.2-1.3,0.7-1.8l5.8-5.8H2.4c-0.7,0-1.3-0.2-1.7-0.7 c-0.4-0.5-0.6-1.1-0.6-1.8v-2.5C0.1,18,0.3,17.5,0.7,17z M36.4,4.7h-3.9c-0.8,0-1.5,0.7-1.5,1.5v27.6c0,0.8,0.7,1.5,1.5,1.5h3.9 c0.8,0,1.5-0.7,1.5-1.5V6.2C37.9,5.4,37.2,4.7,36.4,4.7z" />
    </symbol>
    <symbol id="icon-5781ca2e1fb79e9a339ab93b15347b29" viewBox="0 0 40 40">
      <path
        d="M36.3,32.1c-2.6,0.7-5.5-0.9-6.8-3.5l-2.9-6.2H20h-6.6l-2.9,6.2c-1.2,2.6-4.1,4.2-6.8,3.5 c-2.6-0.7-4.2-3.4-3.5-6L2,19.3C2,19.2,2,19.1,2.1,19l1.5-5.8c0.8-3,3.9-5.4,6.9-5.4H20h9.5c3,0,6.1,2.4,6.9,5.4l1.5,5.8 c0,0.1,0.1,0.2,0.1,0.3l1.8,6.8C40.5,28.7,39,31.4,36.3,32.1z M16.2,15c0-0.5-0.4-0.9-0.9-0.9h-2.5v-2.5c0-0.5-0.4-0.9-0.9-0.9H11 c-0.5,0-0.9,0.4-0.9,0.9v2.5H7.5c-0.5,0-0.9,0.4-0.9,0.9v0.8c0,0.5,0.4,0.9,0.9,0.9h2.6v2.6c0,0.5,0.4,0.9,0.9,0.9h0.8 c0.5,0,0.9-0.4,0.9-0.9v-2.6h2.5c0.5,0,0.9-0.4,0.9-0.9V15z M25.4,13.8c-0.9,0-1.7,0.7-1.7,1.7s0.7,1.7,1.7,1.7 c0.9,0,1.7-0.7,1.7-1.7S26.3,13.8,25.4,13.8z M28.7,10.5c-0.9,0-1.7,0.7-1.7,1.7c0,0.9,0.7,1.7,1.7,1.7c0.9,0,1.7-0.7,1.7-1.7 C30.3,11.2,29.6,10.5,28.7,10.5z M28.7,17c-0.9,0-1.7,0.7-1.7,1.7c0,0.9,0.7,1.7,1.7,1.7c0.9,0,1.7-0.7,1.7-1.7 C30.3,17.8,29.6,17,28.7,17z M31.9,13.8c-0.9,0-1.7,0.7-1.7,1.7s0.7,1.7,1.7,1.7c0.9,0,1.7-0.7,1.7-1.7S32.9,13.8,31.9,13.8z" />
    </symbol>
    <symbol id="icon-396f473e8a8386b5ca989ade22d6ada7" viewBox="0 0 40 40">
      <path
        d="M32.4,34.7c-0.3,0.3-0.7,0.5-1.1,0.5H9.1c-0.4,0-0.8-0.2-1.1-0.5c-0.3-0.3-0.5-0.7-0.5-1.1V6.4 C7.5,6,7.7,5.6,8,5.3C8.3,5,8.7,4.8,9.1,4.8h13.3l-0.1,9.3c0,0.4,0.2,0.8,0.5,1.1c0.3,0.3,0.7,0.5,1.1,0.5h9v17.9 C32.9,34,32.7,34.4,32.4,34.7z M14.4,23.5c0.3-0.5,0.8-0.8,1.4-0.8c0.3,0,0.5,0.1,0.7,0.2c0.2,0.1,0.4,0.3,0.6,0.5 c0.1,0.1,0.2,0.3,0.3,0.6l2.4-0.6c-0.3-1-0.8-1.7-1.4-2.1c-0.6-0.5-1.5-0.7-2.6-0.7c-1.4,0-2.5,0.4-3.2,1.2c-0.8,0.8-1.1,2-1.1,3.5 c0,1.1,0.2,2.1,0.7,2.8c0.4,0.7,1,1.2,1.5,1.5c0.6,0.3,1.4,0.4,2.3,0.4c0.8,0,1.4-0.1,1.9-0.4c0.5-0.2,0.9-0.6,1.3-1.1 c0.3-0.5,0.6-1,0.7-1.7l-2.4-0.7c-0.1,0.6-0.3,1-0.6,1.3c-0.3,0.3-0.7,0.5-1.2,0.5c-0.5,0-0.9-0.2-1.2-0.6C14.2,27,14,26.4,14,25.3 C14,24.5,14.2,23.9,14.4,23.5z M26.9,20.8L25,27.4l-2-6.6h-2.8l3.3,9.1h2.9l3.2-9.1H26.9z M24.5,5.5c0.2,0.2,0.4,0.3,0.6,0.5 l6.8,6.9c0.2,0.2,0.3,0.4,0.5,0.6l-7.9-0.1V5.5z" />
    </symbol>
    <symbol id="icon-7a66fac84dc5d9fb5fafce395a384d40" viewBox="0 0 40 40">
      <path
        d="M20,3C10.6,3,3,10.6,3,20s7.6,17,17,17s17-7.6,17-17S29.4,3,20,3z M34.8,18.9h-6.2c-0.1-2.2-0.3-4.2-0.8-6.1 c1.5-0.4,3-0.9,4.2-1.5c0.6,0.9,1.2,1.8,1.6,2.9C34.3,15.7,34.7,17.3,34.8,18.9z M25.7,26.7c-1.5-0.3-3.1-0.4-4.6-0.5v-5.1h5.4 c-0.1,1.8-0.3,3.5-0.6,5.1C25.8,26.3,25.8,26.5,25.7,26.7z M14.2,26.2c-0.3-1.6-0.6-3.3-0.6-5.1h5.4v5.1c-1.6,0-3.2,0.2-4.6,0.5 C14.2,26.5,14.2,26.3,14.2,26.2z M14.3,13.3c1.5,0.3,3.1,0.4,4.6,0.5v5.1h-5.4c0.1-1.8,0.3-3.5,0.6-5.1 C14.2,13.7,14.2,13.5,14.3,13.3z M21.1,5.4C21.4,5.6,21.7,5.7,22,6c0.8,0.7,1.6,1.7,2.2,3c0.4,0.7,0.7,1.5,0.9,2.3 c-1.3,0.2-2.7,0.4-4,0.4V5.4z M18,6c0.3-0.3,0.6-0.4,0.9-0.6v6.2c-1.4,0-2.8-0.2-4-0.4c0.3-0.8,0.6-1.6,0.9-2.3 C16.5,7.7,17.2,6.7,18,6z M18.9,28.4v6.2c-0.3-0.1-0.6-0.3-0.9-0.6c-0.8-0.7-1.6-1.7-2.2-3c-0.4-0.7-0.7-1.5-0.9-2.3 C16.2,28.6,17.5,28.4,18.9,28.4z M22,34c-0.3,0.3-0.6,0.4-0.9,0.6v-6.2c1.4,0,2.8,0.2,4,0.4c-0.3,0.8-0.6,1.6-0.9,2.3 C23.5,32.3,22.8,33.3,22,34z M21.1,18.9v-5.1c1.6,0,3.2-0.2,4.6-0.5c0,0.2,0.1,0.4,0.1,0.5c0.3,1.6,0.6,3.3,0.6,5.1H21.1z M30.5,9.5 c0,0,0.1,0.1,0.1,0.1c-1,0.4-2.2,0.8-3.4,1.1c-0.6-1.9-1.4-3.5-2.4-4.8c0.3,0.1,0.6,0.2,0.9,0.3C27.5,7.1,29.1,8.1,30.5,9.5z M14.2,6.3c0.3-0.1,0.6-0.2,0.9-0.3c-0.9,1.3-1.7,2.9-2.4,4.8c-1.2-0.3-2.3-0.7-3.4-1.1c0,0,0.1-0.1,0.1-0.1 C10.9,8.1,12.5,7.1,14.2,6.3z M7.9,11.4c1.3,0.6,2.7,1.1,4.2,1.5c-0.4,1.9-0.7,3.9-0.8,6.1H5.2c0.1-1.6,0.5-3.2,1.1-4.7 C6.8,13.2,7.3,12.3,7.9,11.4z M5.2,21.1h6.2c0.1,2.2,0.3,4.2,0.8,6.1c-1.5,0.4-3,0.9-4.2,1.5c-0.6-0.9-1.2-1.8-1.6-2.9 C5.7,24.3,5.3,22.7,5.2,21.1z M9.5,30.5c0,0-0.1-0.1-0.1-0.1c1-0.4,2.2-0.8,3.4-1.1c0.6,1.9,1.4,3.5,2.4,4.8 c-0.3-0.1-0.6-0.2-0.9-0.3C12.5,32.9,10.9,31.9,9.5,30.5z M25.8,33.7c-0.3,0.1-0.6,0.2-0.9,0.3c0.9-1.3,1.7-2.9,2.4-4.8 c1.2,0.3,2.3,0.7,3.4,1.1c0,0-0.1,0.1-0.1,0.1C29.1,31.9,27.5,32.9,25.8,33.7z M32.1,28.6c-1.3-0.6-2.7-1.1-4.2-1.5 c0.4-1.9,0.7-3.9,0.8-6.1h6.2c-0.1,1.6-0.5,3.2-1.1,4.7C33.2,26.8,32.7,27.7,32.1,28.6z" />
    </symbol>
    <symbol id="icon-6f1498c47b5f47672990badd5a8b1884" viewBox="0 0 40 40">
      <path
        d="M31.7,20.9L17.1,35.5c-0.2,0.2-0.5,0.4-0.9,0.4c-0.3,0-0.6-0.1-0.9-0.4l-3.3-3.3c-0.2-0.2-0.4-0.5-0.4-0.9 c0-0.3,0.1-0.6,0.4-0.9L22.5,20L12.1,9.6c-0.2-0.2-0.4-0.5-0.4-0.9c0-0.3,0.1-0.6,0.4-0.9l3.3-3.3c0.2-0.2,0.5-0.4,0.9-0.4 c0.3,0,0.6,0.1,0.9,0.4l14.6,14.6c0.2,0.2,0.4,0.5,0.4,0.9C32,20.3,31.9,20.6,31.7,20.9z" />
    </symbol>
    <symbol id="icon-c3c8e1063e3b7f84f6b54712741de139" viewBox="0 0 40 40">
      <path
        d="M37.3,15.3v15.3c0,0.8-0.3,1.6-0.9,2.2c-0.6,0.6-1.4,0.9-2.2,0.9H5.8c-0.8,0-1.6-0.3-2.2-0.9s-0.9-1.4-0.9-2.2V15.3 c0.5,0.6,1.2,1.1,2,1.7c4.7,3.1,7.9,5.4,9.6,6.7c0.7,0.5,1.4,0.9,1.8,1.2c0.4,0.3,1,0.6,1.9,0.9c0.7,0.3,1.5,0.5,2.1,0.5l0,0 c0.6,0,1.4-0.2,2.1-0.5c0.7-0.3,1.4-0.6,1.9-0.9c0.4-0.3,1-0.7,1.8-1.2c2.2-1.6,5.4-3.8,9.6-6.7C36.1,16.5,36.7,15.9,37.3,15.3 L37.3,15.3z M37.3,9.6c0,1-0.3,2-0.9,2.9c-0.6,0.9-1.5,1.8-2.4,2.4c-4.9,3.3-7.9,5.4-9,6.2c-0.1,0.1-0.4,0.3-0.8,0.6 c-0.4,0.3-0.7,0.5-1,0.7c-0.3,0.2-0.6,0.4-1,0.6c-0.4,0.2-0.7,0.4-1.1,0.5c-0.4,0.1-0.6,0.2-0.9,0.2l0,0c-0.3,0-0.6-0.1-0.9-0.2 c-0.3-0.1-0.7-0.3-1.1-0.5c-0.4-0.2-0.7-0.4-1-0.6c-0.3-0.2-0.6-0.4-1-0.7c-0.4-0.3-0.7-0.5-0.8-0.6c-1.1-0.8-2.8-2-5.1-3.5 c-2.3-1.6-3.3-2.4-3.7-2.7c-0.8-0.5-1.6-1.2-2.3-2.2s-1-1.9-1-2.6c0-1,0.3-1.9,0.8-2.5c0.5-0.6,1.2-1,2.3-1h28.4 c0.8,0,1.6,0.3,2.2,0.9C37.1,8.1,37.3,8.8,37.3,9.6L37.3,9.6z" />
    </symbol>
    <symbol id="icon-bf393d6ea48a4e69e1ed58a3563b94a5" viewBox="0 0 40 40">
      <path
        d="M12.1,13.8v19.1H5.7V13.8C5.7,13.8,12.1,13.8,12.1,13.8z M12.5,7.9c0,0.9-0.3,1.7-1,2.4c-0.7,0.6-1.5,0.9-2.6,0.9h0 c-1.1,0-1.9-0.3-2.5-0.9c-0.6-0.6-1-1.4-1-2.4c0-1,0.3-1.7,1-2.4S7.9,4.6,9,4.6s1.9,0.3,2.6,0.9S12.5,6.9,12.5,7.9z M35,22v11h-6.4 V22.7c0-1.4-0.3-2.4-0.8-3.2c-0.5-0.8-1.3-1.1-2.4-1.1c-0.8,0-1.5,0.2-2,0.7c-0.5,0.4-1,1-1.2,1.7c-0.1,0.4-0.2,0.9-0.2,1.6v10.7 h-6.4c0-5.1,0-9.3,0-12.5s0-5.1,0-5.7l0-0.9H22v2.8h0c0.3-0.4,0.5-0.8,0.8-1.1c0.3-0.3,0.6-0.6,1.1-1c0.5-0.4,1-0.6,1.7-0.8 c0.7-0.2,1.4-0.3,2.2-0.3c2.2,0,4,0.7,5.3,2.2C34.4,17,35,19.1,35,22L35,22z" />
    </symbol>
    <symbol id="icon-8c4b37645de3c276d895d87df51ba614" viewBox="0 0 40 40">
      <path
        d="M36,20.3c0,3.5-1,6.6-3.1,9.4c-2,2.8-4.7,4.7-7.9,5.8c-0.4,0.1-0.6,0-0.8-0.1c-0.2-0.2-0.3-0.4-0.3-0.6v-4.4 c0-1.3-0.4-2.3-1.1-3c0.8-0.1,1.5-0.2,2.1-0.4c0.6-0.2,1.3-0.4,2-0.8c0.7-0.4,1.2-0.8,1.7-1.4c0.5-0.5,0.8-1.3,1.1-2.2 s0.4-2,0.4-3.1c0-1.7-0.5-3.1-1.6-4.3c0.5-1.3,0.5-2.7-0.2-4.2c-0.4-0.1-1,0-1.7,0.2c-0.7,0.3-1.4,0.6-1.9,0.9L24,12.5 c-1.3-0.4-2.6-0.5-4-0.5s-2.7,0.2-4,0.5c-0.2-0.2-0.5-0.3-0.9-0.6c-0.4-0.2-0.9-0.5-1.7-0.8c-0.8-0.3-1.4-0.4-1.8-0.3 c-0.6,1.6-0.7,3-0.1,4.2c-1.1,1.2-1.6,2.6-1.6,4.3c0,1.2,0.1,2.2,0.4,3.1s0.6,1.6,1.1,2.2s1,1,1.7,1.4c0.7,0.4,1.3,0.6,2,0.8 c0.6,0.2,1.3,0.3,2.1,0.4c-0.6,0.5-0.9,1.2-1,2.1c-0.3,0.1-0.6,0.2-0.9,0.3c-0.3,0.1-0.7,0.1-1.2,0.1c-0.5,0-0.9-0.1-1.4-0.4 c-0.5-0.3-0.8-0.7-1.2-1.3c-0.3-0.4-0.6-0.8-1-1.1c-0.4-0.3-0.8-0.4-1-0.5L9,26.5c-0.3,0-0.5,0-0.6,0.1c-0.1,0.1-0.1,0.1-0.1,0.2 c0,0.1,0.1,0.2,0.2,0.3c0.1,0.1,0.2,0.2,0.3,0.2l0.1,0.1c0.3,0.1,0.6,0.4,0.9,0.8s0.5,0.7,0.7,1.1l0.2,0.5c0.2,0.5,0.5,1,0.9,1.3 c0.4,0.3,0.9,0.5,1.4,0.6c0.5,0.1,1,0.1,1.4,0.1c0.5,0,0.9,0,1.2-0.1l0.5-0.1c0,0.5,0,1.1,0,1.9c0,0.7,0,1.1,0,1.1 c0,0.2-0.1,0.5-0.3,0.6c-0.2,0.2-0.5,0.2-0.8,0.1c-3.2-1.1-5.8-3-7.9-5.8S4,23.8,4,20.3c0-2.9,0.7-5.6,2.1-8S9.5,7.8,12,6.4 s5.1-2.1,8-2.1s5.6,0.7,8,2.1s4.4,3.4,5.8,5.8S36,17.4,36,20.3L36,20.3z" />
    </symbol>
  </svg>
  <div id="wrapper">
    <div id="main">
      <div class="inner">
        <header id="header">
          <div id="container01" class="container default full screen">
            <div class="wrapper">
              <div class="inner">
                <ul id="buttons01" class="style2 buttons">
                  <li><a href="#about" class="button n01" role="button"><svg aria-labelledby="buttons01-icon-1-title">
                        <title id="buttons01-icon-1-title">User</title>
                        <use xlink:href="#icon-added293106ea616175452e6eb0197f0"></use>
                      </svg><span class="label">About me</span></a></li>
                  <li><a href="#projects" class="button n02" role="button"><svg
                        aria-labelledby="buttons01-icon-2-title">
                        <title id="buttons01-icon-2-title">Arrow Last</title>
                        <use xlink:href="#icon-5569d30d08dca4cfb60d1e85346b6cde"></use>
                      </svg><span class="label">Projects</span></a></li>
                  <li><a href="#games" class="button n03" role="button"><svg aria-labelledby="buttons01-icon-3-title">
                        <title id="buttons01-icon-3-title">Gamepad</title>
                        <use xlink:href="#icon-5781ca2e1fb79e9a339ab93b15347b29"></use>
                      </svg><span class="label">Games</span></a></li>
                  <li><a href="#" class="button n04" role="button"><svg aria-labelledby="buttons01-icon-4-title">
                        <title id="buttons01-icon-4-title">CV</title>
                        <use xlink:href="#icon-396f473e8a8386b5ca989ade22d6ada7"></use>
                      </svg><span class="label">Resume</span></a></li>
                  <li><a href="#contact" class="button n05" role="button"><svg aria-labelledby="buttons01-icon-5-title">
                        <title id="buttons01-icon-5-title">Globe</title>
                        <use xlink:href="#icon-7a66fac84dc5d9fb5fafce395a384d40"></use>
                      </svg><span class="label">Contact</span></a></li>
                </ul>
              </div>
            </div>
          </div>
        </header>
        <section id="about-section">
          <div id="container02" class="style2 container columns">
            <div class="wrapper">
              <div class="inner">
                <div>
                  <h2 id="text01" class="style1">Hello!</h2>
                  <p id="text02" class="style2"><span class="p">I&#39;m <strong>Daniel Rosén</strong>, a <strong>Game
                        Programmer</strong> specializing in <strong>AI</strong> and <strong>Combat</strong>.<br />
                      I&#39;m passionate about bringing <strong>NPCs</strong> to life with <strong>immersive
                        behavior</strong> and <strong>engaging game mechanics</strong>.</span><span class="p">Currently,
                      I work on a <strong>co-op multiplayer</strong> game, where I am responsible for
                      <strong>design</strong> and <strong>implemention</strong> of both <strong>boss encounters</strong>
                      and <strong>base enemies</strong>, while also developing and improving core <strong>AI
                        systems</strong>.</span></p>
                  <p id="text08" class="style2">You can reach me <a href="#contact">through here</a>.</p>
                </div>
                <div>
                  <div id="image01" class="image" data-position="center"><span class="frame"><img
                        src="https://danielrosentest.carrd.co/assets/images/image01.jpg?v=d795e2df" alt="" /></span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="games-section">
          <h1 id="text18" class="style4"><strong>Group Projects</strong></h1>
          <div id="container03" class="style2 container columns">
            <div class="wrapper">
              <div class="inner">
                <div>
                  <p id="text05" class="style5">Harbor Havoc</p>
                  <div id="video01" class="video">
                    <div class="frame"><iframe src=""
                        data-src="https://www.youtube-nocookie.com/embed/ZKn69zNtD3Q?autoplay=0&amp;rel=0&amp;loop=0&amp;controls=1&amp;cc_load_policy=0"
                        title="FPS" allowfullscreen="1"></iframe></div>
                  </div>
                  <h3 id="text04" class="style5">Stellas Quest</h3>
                  <div id="video04" class="video">
                    <div class="frame"><iframe src=""
                        data-src="https://www.youtube-nocookie.com/embed/EFjerap1isQ?autoplay=0&amp;rel=0&amp;loop=0&amp;controls=1&amp;cc_load_policy=0"
                        title="Top down adventure" allowfullscreen="1"></iframe></div>
                  </div>
                </div>
                <div>
                  <h3 id="text19" class="style5">Spite Hymn of Hate</h3>
                  <div id="video03" class="video">
                    <div class="frame"><iframe src=""
                        data-src="https://www.youtube-nocookie.com/embed/3NnNZtB4sho?autoplay=0&amp;rel=0&amp;loop=0&amp;controls=1&amp;cc_load_policy=0"
                        title="Diablo clone" allowfullscreen="1"></iframe></div>
                  </div>
                  <h3 id="text03" class="style5">Dissonance</h3>
                  <div id="video02" class="video">
                    <div class="frame"><iframe src=""
                        data-src="https://www.youtube-nocookie.com/embed/X1byxQDmIbg?autoplay=0&amp;rel=0&amp;loop=0&amp;controls=1&amp;cc_load_policy=0"
                        title="2D platformer" allowfullscreen="1"></iframe></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="projects-section">
          <h1 id="text06" class="style4"><strong>Individual Projects</strong></h1>
          <div id="container07" class="style2 container columns">
            <div class="wrapper">
              <div class="inner">
                <div>
                  <h3 id="text17" class="style3">Influence Maps</h3>
                  <p id="text16" class="style2"><span class="p">The <strong>system</strong> provides units with
                      <strong>real-time information</strong> about their <strong>surroundings</strong>, such as threat
                      levels and proximity.</span><span class="p"><strong>Multiple</strong> influence maps can be
                      <strong>dynamically</strong> <strong>combined</strong> during <strong>runtime</strong>, generating
                      <strong>valuable data</strong> that units can use to make <strong>informed
                        decisions</strong>.</span><span class="p">Learn more to see how units <strong>operate
                        solely</strong> based on <strong>influence</strong> data, enabling <strong>autonomous</strong>
                      and <strong>intelligent behavior</strong>.</span></p>
                  <ul id="buttons02" class="style1 buttons">
                    <li><a href="#influencemaps" class="button n01" role="button"><svg
                          aria-labelledby="buttons02-icon-1-title">
                          <title id="buttons02-icon-1-title">Chevron Right</title>
                          <use xlink:href="#icon-6f1498c47b5f47672990badd5a8b1884"></use>
                        </svg><span class="label">Read more</span></a></li>
                  </ul>
                </div>
                <div>
                  <div id="image04" class="image" data-position="center"><a href="#influencemaps"
                      class="frame deferred"><img
                        src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCA0ODAgMjcwIiB3aWR0aD0iNDgwIiBoZWlnaHQ9IjI3MCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI%2BPHJlY3QgZmlsbD0idHJhbnNwYXJlbnQiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiLz48L3N2Zz4%3D"
                        data-src="assets/images/image04.gif?v=d795e2df" alt="" /></a></div>
                </div>
              </div>
            </div>
          </div>
          <div id="container06" class="style2 container columns">
            <div class="wrapper">
              <div class="inner">
                <div>
                  <h3 id="text15" class="style3">Navmesh Pathfinding</h3>
                  <p id="text12" class="style2"><span class="p">The system provides units with waypoints along the
                      navigation mesh, allowing them to move efficiently through complex environments.</span><span
                      class="p">While the final algorithm may seem simple, getting there was a complex challenge.
                      Debugging pathfinding logic required overcoming countless obstacles, uncovering tricky edge cases,
                      and gaining deep insights into the field.</span><span class="p">Learn more to see how I developed
                      my own version through trial and error.</span></p>
                  <ul id="buttons03" class="style1 buttons">
                    <li><a href="#" class="button n01" role="button"><svg aria-labelledby="buttons03-icon-1-title">
                          <title id="buttons03-icon-1-title">Chevron Right</title>
                          <use xlink:href="#icon-6f1498c47b5f47672990badd5a8b1884"></use>
                        </svg><span class="label">Read more</span></a></li>
                  </ul>
                </div>
                <div>
                  <div id="image02" class="image" data-position="center"><a
                      href="https://drossen.github.io/webbsite/assets/FlockingBods.gif" class="frame deferred"><img
                        src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCA4NzYgODc4IiB3aWR0aD0iODc2IiBoZWlnaHQ9Ijg3OCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI%2BPHJlY3QgZmlsbD0iIzA0MDQwNCIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIvPjwvc3ZnPg%3D%3D"
                        data-src="assets/images/image02.gif?v=d795e2df" alt="" /></a></div>
                </div>
              </div>
            </div>
          </div>
          <div id="container04" class="style2 container columns">
            <div class="wrapper">
              <div class="inner">
                <div>
                  <h3 id="text13" class="style3">Flocking Boids</h3>
                  <p id="text14" class="style2"><span class="p">A side project to deepen my understanding of kinematic
                      movement and how to combine velocity-based movement with pathfinding.</span><span class="p">Learn
                      more to see how this small side project evolved into a versatile Steering Controller, which I
                      later applied across multiple game projects to handle AI movement more efficiently.</span></p>
                  <ul id="buttons04" class="style1 buttons">
                    <li><a href="#" class="button n01" role="button"><svg aria-labelledby="buttons04-icon-1-title">
                          <title id="buttons04-icon-1-title">Chevron Right</title>
                          <use xlink:href="#icon-6f1498c47b5f47672990badd5a8b1884"></use>
                        </svg><span class="label">Read more</span></a></li>
                  </ul>
                </div>
                <div>
                  <div id="image03" class="image" data-position="center"><a
                      href="https://drossen.github.io/webbsite/assets/FlockingBods.gif" class="frame deferred"><img
                        src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCA2MDAgMzM4IiB3aWR0aD0iNjAwIiBoZWlnaHQ9IjMzOCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI%2BPHJlY3QgZmlsbD0idHJhbnNwYXJlbnQiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiLz48L3N2Zz4%3D"
                        data-src="assets/images/image03.gif?v=d795e2df" alt="" /></a></div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="influencemaps-section">
          <div id="container10" class="style2 container default">
            <div class="wrapper">
              <div class="inner">
                <h1 id="text21" class="style4">Influence Maps</h1>
                <p id="text32"><em>Showcase behavior using only influence data</em></p>
                <div id="video05" class="video">
                  <video src="assets/Showcase.mp4" poster="" title="InfluenceMaps" preload="auto" playsinline
                    webkit-playsinline controls autoplay muted loop></video>
                </div>
                <p id="text22" class="style2"><span class="p">Green unit (Fleeing) constantly tries to move to a
                    position under least amount of enemy influence (Red units).<br /> Red Units (Enemies) are coded
                    simply to move towards the green unit but will reset upon detecting high enough influence from the
                    blue units.<br /> Blue units (Defenders) constantly tries to position them self on a high threat
                    position around the green. They also take their own team&#39;s proximity into account to keep spread
                    out and avoid clumping up at the same position</span></p>
              </div>
            </div>
          </div>
          <div id="container08" class="style2 container columns">
            <div class="wrapper">
              <div class="inner">
                <div>
                  <h2 id="text28" class="style1">How does it work?</h2>
                  <p id="text26"><span class="p">An Influence Map in its simplest form, is a grid where each cell holds
                      a value representing some influence in the world.<br /> It works by spreading out influence from
                      the units position, creating spatial data describing the units surroundings.</span><span
                      class="p">The system I’m presenting here takes this concept further by allowing multiple influence
                      maps to be combined during runtime, essentially creating a &quot;texture&quot; that AI&#39;s can
                      make strategic decisions based on.</span></p>
                  <hr id="divider03">
                  <h2 id="text25" class="style1">Storing influence values</h2>
                  <div id="slideshow01" class="slideshow" oncontextmenu="return false;" ondragstart="return false;">
                    <div class="content">
                      <div class="bg"></div>
                    </div>
                  </div>
                  <p id="text33" class="style2">On a set timer, the system looks to re-paint influence of all registered
                    units that have moved to a new cell since last update-tick. We spread half the influence on our
                    current position and our future position (position + velocity) to better represent the units
                    influence.</p>
                  <p id="text35" class="style6">Adapting to level geometry</p>
                  <p id="text27" class="style2"><span class="p">As it would not make sense to retrieve or apply values
                      on the other side of walls or outside the map, we want to mark up which cells are
                      valid.</span><span class="p">To do so we compare each cell&#39;s center position against the
                      Navmesh and mark cells outside of it as invalid. Also when both retrieving and applying influence
                      we use a flood fill algorithm (BFS) to adapt it to the level geometry.</span></p>
                  <pre><code class="language-cpp"> class InfluenceMap
void InfluenceMap::FloodFillInfluence(const Vector2i& aOriginCoord, const InfluenceData& aInfluenceData, float aAmount)
{
	InterestTemplate& interestTemplate = myManager->GetImprintTemplate(aInfluenceData);
	FalloffFunction curveFunc = GetFalloffFunction(aInfluenceData.type);
	int radius = interestTemplate.dimensions / 2;
	int maxIterations = radius + 1;
	std::set<int> visited;
	std::queue<std::tuple<Vector2i, Vector2i, int>> bfsQueue;
	Vector2i boundsMin = { std::max(myBoundsMin.x, aOriginCoord.x - radius), std::max(myBoundsMin.y, aOriginCoord.y - radius) };
	Vector2i boundsMax = { std::min(myBoundsMax.x, aOriginCoord.x + radius), std::min(myBoundsMax.y, aOriginCoord.y + radius) };
	bfsQueue.push({ aOriginCoord, interestTemplate.centerCell, 1 });
	int worldStartIndex = aOriginCoord.y * myGridSize.x + aOriginCoord.x;
	int localStartIndex = interestTemplate.centerCell.y * interestTemplate.dimensions + interestTemplate.centerCell.x;
	if (worldStartIndex >= 0 && worldStartIndex < myValues.size())
	{
		myValues[worldStartIndex] += interestTemplate.values[localStartIndex] * aAmount;
		visited.insert(worldStartIndex);
	}
	float bfsFallof = 1.0f;
	int distance = 1;
	int iteration = 1;
	while (!bfsQueue.empty())
	{
		Vector2i nextLocalCoord, nextTemplateCoord;
		Vector2i localCoord, templateCoord;
		std::tie(localCoord, templateCoord, distance) = bfsQueue.front();
		bfsQueue.pop();
		bfsFallof = curveFunc(static_cast<float>(distance), static_cast<float>(maxIterations));
		for (const auto& direction : directions)
		{
			nextLocalCoord = localCoord + direction;
			nextTemplateCoord = templateCoord + direction;
			if (nextLocalCoord.x < boundsMin.x || nextLocalCoord.x > boundsMax.x ||
				nextLocalCoord.y < boundsMin.y || nextLocalCoord.y > boundsMax.y) {
				continue;
			}
			int heatmapIndex = nextLocalCoord.y * myGridSize.x + nextLocalCoord.x;
			int templateIndex = nextTemplateCoord.y * interestTemplate.dimensions + nextTemplateCoord.x;
			if (!myValidCells->at(heatmapIndex)) continue;
			if (visited.find(heatmapIndex) == visited.end())
			{
				myValues[heatmapIndex] += (interestTemplate.values[templateIndex] * bfsFallof) * aAmount;
				bfsQueue.push({ nextLocalCoord, nextTemplateCoord, distance + 1 });
				visited.insert(heatmapIndex);
			}
		}
	}
}
                  </code></pre>
                  <hr id="divider01">
                  <h2 id="text29" class="style1">Initialization process</h2>
                  <p id="text31" class="style2"><span class="p">Units register them self into the system, specifying
                      influence type, spread radius, influence strength and falloff curve.</span><span class="p">The
                      system creates the desired influence maps and stores the information for each user on how their
                      influence should be applied.</span><span class="p">The falloff curve tells the system how the
                      values should be applied based on the distance to the units position. This is useful as some units
                      might not be threatening at close range and want higher values to be applied as the distance
                      increases.</span><span class="p">To further increase performance we can skip running the distance
                      based curve calculations during runtime as the spread radius and falloff curve gives us all
                      information we need to pre-calculate this. The system therefor creates
                      &quot;InterestTemplates&quot; during setup which basically are smaller grids holding the magnitude
                      of the influence values for each cell of the specified radius and type. A small cost of memory but
                      quite a big gain to runtime performance.</span></p>
                  <pre><code class="language-cpp"> class InfluenceManager
void InfluenceManager::InitTemplate(const int aSize, FalloffFunction aFallofCurve, InterestTemplate& aTemplate)
{
  int dimension = (aSize * 2);
  dimension = dimension % 2 != 0 ? dimension : dimension + 1;
  aTemplate.dimensions = dimension;
  aTemplate.values.resize(dimension * dimension);
  aTemplate.centerCell = { dimension / 2, dimension / 2 };
  int index = 0;
  for (int row = 0; row < dimension; row++)
  {
    for (int col = 0; col < dimension; col++)
    {
      int coordDistance = (Vector2i(col, row) - aTemplate.centerCell).LengthSqr();
      float distance = sqrt(static_cast<float>(coordDistance)) * myCellSize;
      float interest = aFallofCurve(distance, static_cast<float>(aSize));
      aTemplate.values[index] = interest;
      index++;
    }
  }
}
                  </code>
                </pre>
                  <hr id="divider02">
                  <h2 id="text23" class="style1">Retrieving information</h2>
                  <div id="image08" class="style3 image" data-position="center"><a
                      href="https://drossen.github.io/webbsite/assets/FlockingBods.gif" class="frame deferred"><img
                        src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTA0IDkzOSIgd2lkdGg9IjExMDQiIGhlaWdodD0iOTM5IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIj48cmVjdCBmaWxsPSIjN2I2Zjg1IiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIi8%2BPC9zdmc%2B"
                        data-src="assets/images/image08.jpg?v=d795e2df" alt="" /></a></div>
                  <p id="text24" class="style2"><span class="p">When retrieving information units request a
                      &quot;Working Map&quot; of a certain size and place (position) in the world.<br /> The modular way
                      of the workmap then allows us to fill it with data from the influence maps by specifying Inlfuence
                      Type, Team and magnitude / strength.</span><span class="p">This is what allows us to combine
                      different types of data and blend it together using different basic math operations such as
                      &quot;Add, Subtract, Multiply or even Invert.</span></p>
                  <pre><code class="language-cpp"> class Workmap
Workmap* workmap = influenceManager->GetWorkmap(scanCenterPosition, scanRadius);
workmap->Add(Team::Player, InfluenceType::Proximity, -1.0);
workmap->ExcludeUserInfluence(user, InfluenceType::Proximity);
workmap->Add(Team::Enemy, InfluenceType::Proximity, 2.0);
                  </code></pre>
                  <h2 id="text38" class="style1">Examples of usage</h2>
                  <p id="text39" class="style2"><span class="p">The dynamic setup of the system allows both dumb and
                      smart AI&#39;s to accomplish their goals by assigning weighted values when retrieving influence
                      data through the Workmap.</span><span class="p">A &quot;dumb&quot; bombardment AI might just care
                      about destroying nearby opponents no mater what, only taking the opponents proximity influence
                      into account.</span><span class="p">A more strategic or &quot;smart&quot; AI might want to take
                      allied units proximity into account when retrieving a position to bombard.</span><span class="p">-
                      Is there threat at my location higher than X? Retrieve a safe position, I want to flee!<br /> - is
                      there threat at my allied healer location? Retrieve position around it with highest amount of
                      threat, I will defend you!<br /> - Do the area around me have a total influence value higher than
                      X? Time to use my Area of effect spell!<br /> - Where do my grenade do most damage? Retrieve the
                      location with highest enemy influence (center of mass)!<br /> - Where are my allies located?
                      Retrieve a position with low location value, I want to spread from my allies!</span></p>
                  <h2 id="text20" class="style1">Further improvements</h2>
                  <p id="text30" class="style2"><span class="p">Having a Octree as main grid that can hold influence
                      maps within it to avoid cells far outside the map.<br /> Add a scheduler to spread out repainting
                      of influence over multiple frames.<br /> Bread-crumbing influence that stays in cells and decay
                      over time.</span></p>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="pathfinding-section"></section>
        <section id="flockingboids-section"></section>
        <section id="contact-section">
          <div id="container05" class="style3 container columns">
            <div class="wrapper">
              <div class="inner">
                <div>
                  <ul id="icons01" class="style1 icons">
                    <li><a class="n01" href="https://www.linkedin.com/in/daniel-ros%C3%A9n/" role="button"><svg
                          aria-labelledby="icons01-icon-1-title">
                          <title id="icons01-icon-1-title">Email</title>
                          <use xlink:href="#icon-c3c8e1063e3b7f84f6b54712741de139"></use>
                        </svg><span class="label">Email</span></a></li>
                  </ul>
                  <ul id="icons02" class="style1 icons">
                    <li><a class="n01" href="#" role="button"><svg aria-labelledby="icons02-icon-1-title">
                          <title id="icons02-icon-1-title">LinkedIn</title>
                          <use xlink:href="#icon-bf393d6ea48a4e69e1ed58a3563b94a5"></use>
                        </svg><span class="label">LinkedIn</span></a></li>
                  </ul>
                  <ul id="icons03" class="style1 icons">
                    <li><a class="n01" href="#" role="button"><svg aria-labelledby="icons03-icon-1-title">
                          <title id="icons03-icon-1-title">GitHub</title>
                          <use xlink:href="#icon-8c4b37645de3c276d895d87df51ba614"></use>
                        </svg><span class="label">GitHub</span></a></li>
                  </ul>
                </div>
                <div>
                  <p id="text10">Work in progress</p>
                  <p id="text09">Work in progress</p>
                  <p id="text11">Work in progress</p>
                </div>
              </div>
            </div>
          </div>
        </section>
        <footer id="footer"></footer>
      </div>
    </div>
  </div>
  <script>(function () { var on = addEventListener, off = removeEventListener, $ = function (q) { return document.querySelector(q) }, $$ = function (q) { return document.querySelectorAll(q) }, $body = document.body, $inner = $('.inner'), client = (function () { var o = { browser: 'other', browserVersion: 0, os: 'other', osVersion: 0, mobile: false, canUse: null, flags: { lsdUnits: false, }, }, ua = navigator.userAgent, a, i; a = [['firefox', /Firefox\/([0-9\.]+)/, null], ['edge', /Edge\/([0-9\.]+)/, null], ['safari', /Version\/([0-9\.]+).+Safari/, null], ['chrome', /Chrome\/([0-9\.]+)/, null], ['chrome', /CriOS\/([0-9\.]+)/, null], ['ie', /Trident\/.+rv:([0-9]+)/, null], ['safari', /iPhone OS ([0-9_]+)/, function (v) { return v.replace('_', '.').replace('_', ''); }]]; for (i = 0; i < a.length; i++) { if (ua.match(a[i][1])) { o.browser = a[i][0]; o.browserVersion = parseFloat(a[i][2] ? (a[i][2])(RegExp.$1) : RegExp.$1); break; } } a = [['ios', /([0-9_]+) like Mac OS X/, function (v) { return v.replace('_', '.').replace('_', ''); }], ['ios', /CPU like Mac OS X/, function (v) { return 0 }], ['ios', /iPad; CPU/, function (v) { return 0 }], ['android', /Android ([0-9\.]+)/, null], ['mac', /Macintosh.+Mac OS X ([0-9_]+)/, function (v) { return v.replace('_', '.').replace('_', ''); }], ['windows', /Windows NT ([0-9\.]+)/, null], ['undefined', /Undefined/, null]]; for (i = 0; i < a.length; i++) { if (ua.match(a[i][1])) { o.os = a[i][0]; o.osVersion = parseFloat(a[i][2] ? (a[i][2])(RegExp.$1) : RegExp.$1); break; } } if (o.os == 'mac' && ('ontouchstart' in window) && ((screen.width == 1024 && screen.height == 1366) || (screen.width == 834 && screen.height == 1112) || (screen.width == 810 && screen.height == 1080) || (screen.width == 768 && screen.height == 1024))) o.os = 'ios'; o.mobile = (o.os == 'android' || o.os == 'ios'); var _canUse = document.createElement('div'); o.canUse = function (property, value) { var style; style = _canUse.style; if (!(property in style)) return false; if (typeof value !== 'undefined') { style[property] = value; if (style[property] == '') return false; } return true; }; o.flags.lsdUnits = o.canUse('width', '100dvw'); return o; }()), ready = { list: [], add: function (f) { this.list.push(f); }, run: function () { this.list.forEach((f) => { f(); }); }, }, trigger = function (t) { dispatchEvent(new Event(t)); }, cssRules = function (selectorText) { var ss = document.styleSheets, a = [], f = function (s) { var r = s.cssRules, i; for (i = 0; i < r.length; i++) { if (r[i] instanceof CSSMediaRule && matchMedia(r[i].conditionText).matches) (f)(r[i]); else if (r[i] instanceof CSSStyleRule && r[i].selectorText == selectorText) a.push(r[i]); } }, x, i; for (i = 0; i < ss.length; i++)f(ss[i]); return a; }, escapeHtml = function (s) { if (s === '' || s === null || s === undefined) return ''; var a = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;', }; s = s.replace(/[&<>"']/g, function (x) { return a[x]; }); return s; }, thisHash = function () { var h = location.hash ? location.hash.substring(1) : null, a; if (!h) return null; if (h.match(/\?/)) { a = h.split('?'); h = a[0]; history.replaceState(undefined, undefined, '#' + h); window.location.search = a[1]; } if (h.length > 0 && !h.match(/^[a-zA-Z]/)) h = 'x' + h; if (typeof h == 'string') h = h.toLowerCase(); return h; }, scrollToElement = function (e, style, duration) { var y, cy, dy, start, easing, offset, f; if (!e) y = 0; else { offset = (e.dataset.scrollOffset ? parseInt(e.dataset.scrollOffset) : 0) * parseFloat(getComputedStyle(document.documentElement).fontSize); switch (e.dataset.scrollBehavior ? e.dataset.scrollBehavior : 'default') { case 'default': default: y = e.offsetTop + offset; break; case 'center': if (e.offsetHeight < window.innerHeight) y = e.offsetTop - ((window.innerHeight - e.offsetHeight) / 2) + offset; else y = e.offsetTop - offset; break; case 'previous': if (e.previousElementSibling) y = e.previousElementSibling.offsetTop + e.previousElementSibling.offsetHeight + offset; else y = e.offsetTop + offset; break; } } if (!style) style = 'smooth'; if (!duration) duration = 750; if (style == 'instant') { window.scrollTo(0, y); return; } start = Date.now(); cy = window.scrollY; dy = y - cy; switch (style) { case 'linear': easing = function (t) { return t }; break; case 'smooth': easing = function (t) { return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1 }; break; }f = function () { var t = Date.now() - start; if (t >= duration) window.scroll(0, y); else { window.scroll(0, cy + (dy * easing(t / duration))); requestAnimationFrame(f); } }; f(); }, scrollToTop = function () { scrollToElement(null); }, loadElements = function (parent) { var a, e, x, i; a = parent.querySelectorAll('iframe[data-src]:not([data-src=""])'); for (i = 0; i < a.length; i++) { a[i].contentWindow.location.replace(a[i].dataset.src); a[i].dataset.initialSrc = a[i].dataset.src; a[i].dataset.src = ''; } a = parent.querySelectorAll('video[autoplay]'); for (i = 0; i < a.length; i++) { if (a[i].paused) a[i].play(); } e = parent.querySelector('[data-autofocus="1"]'); x = e ? e.tagName : null; switch (x) { case 'FORM': e = e.querySelector('.field input, .field select, .field textarea'); if (e) e.focus(); break; default: break; }a = parent.querySelectorAll('unloaded-script'); for (i = 0; i < a.length; i++) { x = document.createElement('script'); x.setAttribute('data-loaded', ''); if (a[i].getAttribute('src')) x.setAttribute('src', a[i].getAttribute('src')); if (a[i].textContent) x.textContent = a[i].textContent; a[i].replaceWith(x); } x = new Event('loadelements'); a = parent.querySelectorAll('[data-unloaded]'); a.forEach((element) => { element.removeAttribute('data-unloaded'); element.dispatchEvent(x); }); }, unloadElements = function (parent) { var a, e, x, i; a = parent.querySelectorAll('iframe[data-src=""]'); for (i = 0; i < a.length; i++) { if (a[i].dataset.srcUnload === '0') continue; if ('initialSrc' in a[i].dataset) a[i].dataset.src = a[i].dataset.initialSrc; else a[i].dataset.src = a[i].src; a[i].contentWindow.location.replace('about:blank'); } a = parent.querySelectorAll('video'); for (i = 0; i < a.length; i++) { if (!a[i].paused) a[i].pause(); } e = $(':focus'); if (e) e.blur(); }; window._scrollToTop = scrollToTop; var thisUrl = function () { return window.location.href.replace(window.location.search, '').replace(/#$/, ''); }; var getVar = function (name) { var a = window.location.search.substring(1).split('&'), b, k; for (k in a) { b = a[k].split('='); if (b[0] == name) return b[1]; } return null; }; var errors = { handle: function (handler) { window.onerror = function (message, url, line, column, error) { (handler)(error.message); return true; }; }, unhandle: function () { window.onerror = null; } }; (function () { var initialSection, initialScrollPoint, initialId, header, footer, name, hideHeader, hideFooter, disableAutoScroll, h, e, ee, k, locked = false, title = document.title, scrollPointParent = function (target) { while (target) { if (target.parentElement && target.parentElement.tagName == 'SECTION') break; target = target.parentElement; } return target; }, scrollPointSpeed = function (scrollPoint) { let x = parseInt(scrollPoint.dataset.scrollSpeed); switch (x) { case 5: return 250; case 4: return 500; case 3: return 750; case 2: return 1000; case 1: return 1250; default: break; }return 750; }, doNextScrollPoint = function (event) { var e, target, id; e = scrollPointParent(event.target); if (!e) return; while (e && e.nextElementSibling) { e = e.nextElementSibling; if (e.dataset.scrollId) { target = e; id = e.dataset.scrollId; break; } } if (!target || !id) return; if (target.dataset.scrollInvisible == '1') scrollToElement(target, 'smooth', scrollPointSpeed(target)); else location.href = '#' + id; }, doPreviousScrollPoint = function (e) { var e, target, id; e = scrollPointParent(event.target); if (!e) return; while (e && e.previousElementSibling) { e = e.previousElementSibling; if (e.dataset.scrollId) { target = e; id = e.dataset.scrollId; break; } } if (!target || !id) return; if (target.dataset.scrollInvisible == '1') scrollToElement(target, 'smooth', scrollPointSpeed(target)); else location.href = '#' + id; }, doFirstScrollPoint = function (e) { var e, target, id; e = scrollPointParent(event.target); if (!e) return; while (e && e.previousElementSibling) { e = e.previousElementSibling; if (e.dataset.scrollId) { target = e; id = e.dataset.scrollId; } } if (!target || !id) return; if (target.dataset.scrollInvisible == '1') scrollToElement(target, 'smooth', scrollPointSpeed(target)); else location.href = '#' + id; }, doLastScrollPoint = function (e) { var e, target, id; e = scrollPointParent(event.target); if (!e) return; while (e && e.nextElementSibling) { e = e.nextElementSibling; if (e.dataset.scrollId) { target = e; id = e.dataset.scrollId; } } if (!target || !id) return; if (target.dataset.scrollInvisible == '1') scrollToElement(target, 'smooth', scrollPointSpeed(target)); else location.href = '#' + id; }, doNextSection = function () { var section; section = $('#main > .inner > section.active').nextElementSibling; if (!section || section.tagName != 'SECTION') return; location.href = '#' + section.id.replace(/-section$/, ''); }, doPreviousSection = function () { var section; section = $('#main > .inner > section.active').previousElementSibling; if (!section || section.tagName != 'SECTION') return; location.href = '#' + (section.matches(':first-child') ? '' : section.id.replace(/-section$/, '')); }, doFirstSection = function () { var section; section = $('#main > .inner > section:first-of-type'); if (!section || section.tagName != 'SECTION') return; location.href = '#' + section.id.replace(/-section$/, ''); }, doLastSection = function () { var section; section = $('#main > .inner > section:last-of-type'); if (!section || section.tagName != 'SECTION') return; location.href = '#' + section.id.replace(/-section$/, ''); }, resetSectionChangeElements = function (section) { var ee, e, x; ee = section.querySelectorAll('[data-reset-on-section-change="1"]'); for (e of ee) { x = e ? e.tagName : null; switch (x) { case 'FORM': e.reset(); break; default: break; } } }, activateSection = function (section, scrollPoint) { var sectionHeight, currentSection, currentSectionHeight, name, hideHeader, hideFooter, disableAutoScroll, ee, k; if (!section.classList.contains('inactive')) { name = (section ? section.id.replace(/-section$/, '') : null); disableAutoScroll = name ? ((name in sections) && ('disableAutoScroll' in sections[name]) && sections[name].disableAutoScroll) : false; if (scrollPoint) scrollToElement(scrollPoint, 'smooth', scrollPointSpeed(scrollPoint)); else if (!disableAutoScroll) scrollToElement(null); return false; } else { locked = true; if (location.hash == '#about') history.replaceState(null, null, '#'); name = (section ? section.id.replace(/-section$/, '') : null); hideHeader = name ? ((name in sections) && ('hideHeader' in sections[name]) && sections[name].hideHeader) : false; hideFooter = name ? ((name in sections) && ('hideFooter' in sections[name]) && sections[name].hideFooter) : false; disableAutoScroll = name ? ((name in sections) && ('disableAutoScroll' in sections[name]) && sections[name].disableAutoScroll) : false; if (header && hideHeader) { header.classList.add('hidden'); header.style.display = 'none'; } if (footer && hideFooter) { footer.classList.add('hidden'); footer.style.display = 'none'; } currentSection = $('#main > .inner > section:not(.inactive)'); currentSection.classList.add('inactive'); currentSection.classList.remove('active'); currentSection.style.display = 'none'; document.title = title; unloadElements(currentSection); resetSectionChangeElements(currentSection); clearTimeout(window._sectionTimeoutId); if (header && !hideHeader) { header.style.display = ''; header.classList.remove('hidden'); } if (footer && !hideFooter) { footer.style.display = ''; footer.classList.remove('hidden'); } section.classList.remove('inactive'); section.classList.add('active'); section.style.display = ''; trigger('resize'); if (section.dataset.title) document.title = section.dataset.title + ' - ' + title; loadElements(section); if (scrollPoint) scrollToElement(scrollPoint, 'instant'); else if (!disableAutoScroll) scrollToElement(null, 'instant'); locked = false; } }, sections = {}; window._nextScrollPoint = doNextScrollPoint; window._previousScrollPoint = doPreviousScrollPoint; window._firstScrollPoint = doFirstScrollPoint; window._lastScrollPoint = doLastScrollPoint; window._nextSection = doNextSection; window._previousSection = doPreviousSection; window._firstSection = doFirstSection; window._lastSection = doLastSection; window._scrollToTop = function () { var section, id; scrollToElement(null); if (!!(section = $('section.active'))) { id = section.id.replace(/-section$/, ''); if (id == 'about') id = ''; history.pushState(null, null, '#' + id); } }; if ('scrollRestoration' in history) history.scrollRestoration = 'manual'; header = $('#header'); footer = $('#footer'); h = thisHash(); if (h && !h.match(/^[a-zA-Z0-9\-]+$/)) h = null; if (e = $('[data-scroll-id="' + h + '"]')) { initialScrollPoint = e; initialSection = initialScrollPoint.parentElement; initialId = initialSection.id; } else if (e = $('#' + (h ? h : 'about') + '-section')) { initialScrollPoint = null; initialSection = e; initialId = initialSection.id; } if (!initialSection) { initialScrollPoint = null; initialSection = $('#' + 'about' + '-section'); initialId = initialSection.id; history.replaceState(undefined, undefined, '#'); } name = (h ? h : 'about'); hideHeader = name ? ((name in sections) && ('hideHeader' in sections[name]) && sections[name].hideHeader) : false; hideFooter = name ? ((name in sections) && ('hideFooter' in sections[name]) && sections[name].hideFooter) : false; disableAutoScroll = name ? ((name in sections) && ('disableAutoScroll' in sections[name]) && sections[name].disableAutoScroll) : false; if (header && hideHeader) { header.classList.add('hidden'); header.style.display = 'none'; } if (footer && hideFooter) { footer.classList.add('hidden'); footer.style.display = 'none'; } ee = $$('#main > .inner > section:not([id="' + initialId + '"])'); for (k = 0; k < ee.length; k++) { ee[k].className = 'inactive'; ee[k].style.display = 'none'; } initialSection.classList.add('active'); ready.add(() => { if (initialSection.dataset.title) document.title = initialSection.dataset.title + ' - ' + title; loadElements(initialSection); if (header) loadElements(header); if (footer) loadElements(footer); if (!disableAutoScroll) scrollToElement(null, 'instant'); }); on('load', function () { if (initialScrollPoint) scrollToElement(initialScrollPoint, 'instant'); }); on('hashchange', function (event) { var section, scrollPoint, h, e; if (locked) return false; h = thisHash(); if (h && !h.match(/^[a-zA-Z0-9\-]+$/)) return false; if (e = $('[data-scroll-id="' + h + '"]')) { scrollPoint = e; section = scrollPoint.parentElement; } else if (e = $('#' + (h ? h : 'about') + '-section')) { scrollPoint = null; section = e; } else { scrollPoint = null; section = $('#' + 'about' + '-section'); history.replaceState(undefined, undefined, '#'); } if (!section) return false; activateSection(section, scrollPoint); return false; }); on('click', function (event) { var t = event.target, tagName = t.tagName.toUpperCase(), scrollPoint, section; switch (tagName) { case 'IMG': case 'SVG': case 'USE': case 'U': case 'STRONG': case 'EM': case 'CODE': case 'S': case 'MARK': case 'SPAN': while (!!(t = t.parentElement)) if (t.tagName == 'A') break; if (!t) return; break; default: break; }if (t.tagName == 'A' && t.getAttribute('href') !== null && t.getAttribute('href').substr(0, 1) == '#') { if (!!(scrollPoint = $('[data-scroll-id="' + t.hash.substr(1) + '"][data-scroll-invisible="1"]'))) { event.preventDefault(); section = scrollPoint.parentElement; if (section.classList.contains('inactive')) { history.pushState(null, null, '#' + section.id.replace(/-section$/, '')); activateSection(section, scrollPoint); } else { scrollToElement(scrollPoint, 'smooth', scrollPointSpeed(scrollPoint)); } } else if (t.hash == window.location.hash) { event.preventDefault(); history.replaceState(undefined, undefined, '#'); location.replace(t.hash); } } }); })(); var style, sheet, rule; style = document.createElement('style'); style.appendChild(document.createTextNode('')); document.head.appendChild(style); sheet = style.sheet; if (client.mobile) { (function () { if (client.flags.lsdUnits) { document.documentElement.style.setProperty('--viewport-height', '100svh'); document.documentElement.style.setProperty('--background-height', '100lvh'); } else { var f = function () { document.documentElement.style.setProperty('--viewport-height', window.innerHeight + 'px'); document.documentElement.style.setProperty('--background-height', (window.innerHeight + 250) + 'px'); }; on('load', f); on('orientationchange', function () { setTimeout(function () { (f)(); }, 100); }); } })(); } if (client.os == 'android') { (function () { sheet.insertRule('body::after { }', 0); rule = sheet.cssRules[0]; var f = function () { rule.style.cssText = 'height: ' + (Math.max(screen.width, screen.height)) + 'px'; }; on('load', f); on('orientationchange', f); on('touchmove', f); })(); $body.classList.add('is-touch'); } else if (client.os == 'ios') { if (client.osVersion <= 11) (function () { sheet.insertRule('body::after { }', 0); rule = sheet.cssRules[0]; rule.style.cssText = '-webkit-transform: scale(1.0)'; })(); if (client.osVersion <= 11) (function () { sheet.insertRule('body.ios-focus-fix::before { }', 0); rule = sheet.cssRules[0]; rule.style.cssText = 'height: calc(100% + 60px)'; on('focus', function (event) { $body.classList.add('ios-focus-fix'); }, true); on('blur', function (event) { $body.classList.remove('ios-focus-fix'); }, true); })(); $body.classList.add('is-touch'); } var scrollEvents = { items: [], add: function (o) { this.items.push({ element: o.element, triggerElement: (('triggerElement' in o && o.triggerElement) ? o.triggerElement : o.element), enter: ('enter' in o ? o.enter : null), leave: ('leave' in o ? o.leave : null), mode: ('mode' in o ? o.mode : 4), threshold: ('threshold' in o ? o.threshold : 0.25), offset: ('offset' in o ? o.offset : 0), initialState: ('initialState' in o ? o.initialState : null), state: false, }); }, handler: function () { var height, top, bottom, scrollPad; if (client.os == 'ios') { height = document.documentElement.clientHeight; top = document.body.scrollTop + window.scrollY; bottom = top + height; scrollPad = 125; } else { height = document.documentElement.clientHeight; top = document.documentElement.scrollTop; bottom = top + height; scrollPad = 0; } scrollEvents.items.forEach(function (item) { var elementTop, elementBottom, viewportTop, viewportBottom, bcr, pad, state, a, b; if (!item.enter && !item.leave) return true; if (!item.triggerElement) return true; if (item.triggerElement.offsetParent === null) { if (item.state == true && item.leave) { item.state = false; (item.leave).apply(item.element); if (!item.enter) item.leave = null; } return true; } bcr = item.triggerElement.getBoundingClientRect(); elementTop = top + Math.floor(bcr.top); elementBottom = elementTop + bcr.height; if (item.initialState !== null) { state = item.initialState; item.initialState = null; } else { switch (item.mode) { case 1: default: state = (bottom > (elementTop - item.offset) && top < (elementBottom + item.offset)); break; case 2: a = (top + (height * 0.5)); state = (a > (elementTop - item.offset) && a < (elementBottom + item.offset)); break; case 3: a = top + (height * (item.threshold)); if (a - (height * 0.375) <= 0) a = 0; b = top + (height * (1 - item.threshold)); if (b + (height * 0.375) >= document.body.scrollHeight - scrollPad) b = document.body.scrollHeight + scrollPad; state = (b > (elementTop - item.offset) && a < (elementBottom + item.offset)); break; case 4: pad = height * item.threshold; viewportTop = (top + pad); viewportBottom = (bottom - pad); if (Math.floor(top) <= pad) viewportTop = top; if (Math.ceil(bottom) >= (document.body.scrollHeight - pad)) viewportBottom = bottom; if ((viewportBottom - viewportTop) >= (elementBottom - elementTop)) { state = ((elementTop >= viewportTop && elementBottom <= viewportBottom) || (elementTop >= viewportTop && elementTop <= viewportBottom) || (elementBottom >= viewportTop && elementBottom <= viewportBottom)); } else state = ((viewportTop >= elementTop && viewportBottom <= elementBottom) || (elementTop >= viewportTop && elementTop <= viewportBottom) || (elementBottom >= viewportTop && elementBottom <= viewportBottom)); break; } } if (state != item.state) { item.state = state; if (item.state) { if (item.enter) { (item.enter).apply(item.element); if (!item.leave) item.enter = null; } } else { if (item.leave) { (item.leave).apply(item.element); if (!item.enter) item.leave = null; } } } }); }, init: function () { on('load', this.handler); on('resize', this.handler); on('scroll', this.handler); (this.handler)(); } }; scrollEvents.init(); (function () { var items = $$('.deferred'), loadHandler, enterHandler; loadHandler = function () { var i = this, p = this.parentElement, duration = 375; if (i.dataset.src !== 'done') return; if (Date.now() - i._startLoad < duration) duration = 175; i.style.transitionDuration = (duration / 1000.00) + 's'; p.classList.remove('loading'); i.style.opacity = 1; setTimeout(function () { i.style.backgroundImage = 'none'; i.style.transitionProperty = ''; i.style.transitionTimingFunction = ''; i.style.transitionDuration = ''; }, duration); }; enterHandler = function () { var i = this, p = this.parentElement, src; src = i.dataset.src; i.dataset.src = 'done'; p.classList.add('loading'); i._startLoad = Date.now(); i.src = src; }; items.forEach(function (p) { var i = p.firstElementChild; if (!p.classList.contains('enclosed')) { p.style.backgroundImage = 'url(' + i.src + ')'; p.style.backgroundSize = '100% 100%'; p.style.backgroundPosition = 'top left'; p.style.backgroundRepeat = 'no-repeat'; } i.style.opacity = 0; i.style.transitionProperty = 'opacity'; i.style.transitionTimingFunction = 'ease-in-out'; i.addEventListener('load', loadHandler); scrollEvents.add({ element: i, enter: enterHandler, offset: 250, }); }); })(); function slideshowBackground(id, settings) { var _this = this; if (!('images' in settings) || !('target' in settings)) return; this.id = id; this.wait = ('wait' in settings ? settings.wait : 0); this.defer = ('defer' in settings ? settings.defer : false); this.navigation = ('navigation' in settings ? settings.navigation : false); this.order = ('order' in settings ? settings.order : 'default'); this.preserveImageAspectRatio = ('preserveImageAspectRatio' in settings ? settings.preserveImageAspectRatio : false); this.transition = ('transition' in settings ? settings.transition : { style: 'crossfade', speed: 1000, delay: 6000, resume: 12000 }); this.images = settings.images; this.preload = true; this.locked = false; this.$target = $(settings.target); this.$wrapper = ('wrapper' in settings ? $(settings.wrapper) : null); this.pos = 0; this.lastPos = 0; this.$slides = []; this.img = document.createElement('img'); this.preloadTimeout = null; this.resumeTimeout = null; this.transitionInterval = null; if (window.CARRD_DISABLE_DEFER === true) { this.defer = false; this.preload = false; } if (this.preserveImageAspectRatio && this.transition.style == 'crossfade') this.transition.style = 'fade'; if (this.transition.delay !== false) switch (this.transition.style) { case 'crossfade': this.transition.delay = Math.max(this.transition.delay, this.transition.speed * 2); break; case 'fade': this.transition.delay = Math.max(this.transition.delay, this.transition.speed * 3); break; case 'instant': default: break; }if (!this.$wrapper) this.navigation = false; if (this.defer) { scrollEvents.add({ element: this.$target, enter: function () { _this.preinit(); } }); } else { this.preinit(); } }; slideshowBackground.prototype.speedClassName = function (speed) { switch (speed) { case 1: return 'slow'; default: case 2: return 'normal'; case 3: return 'fast'; } }; slideshowBackground.prototype.preinit = function () { var _this = this; if (this.preload) { this.preloadTimeout = setTimeout(function () { _this.$target.classList.add('is-loading'); }, this.transition.speed); setTimeout(function () { _this.init(); }, 0); } else { this.init(); } }; slideshowBackground.prototype.init = function () { var _this = this, loaded = 0, hasLinks = false, dragStart = null, dragEnd = null, $slide, intervalId, i; this.$target.classList.add('slideshow-background'); this.$target.classList.add(this.transition.style); if (this.navigation) { this.$next = document.createElement('div'); this.$next.classList.add('nav', 'next'); this.$next.addEventListener('click', function (event) { _this.stopTransitioning(); _this.next('default'); }); this.$wrapper.appendChild(this.$next); this.$previous = document.createElement('div'); this.$previous.classList.add('nav', 'previous'); this.$previous.addEventListener('click', function (event) { _this.stopTransitioning(); _this.previous('default'); }); this.$wrapper.appendChild(this.$previous); this.$wrapper.addEventListener('touchstart', function (event) { if (event.touches.length > 1) return; dragStart = { x: event.touches[0].clientX, y: event.touches[0].clientY }; }); this.$wrapper.addEventListener('touchmove', function (event) { var dx, dy; if (!dragStart || event.touches.length > 1) return; dragEnd = { x: event.touches[0].clientX, y: event.touches[0].clientY }; dx = dragStart.x - dragEnd.x; dy = dragStart.y - dragEnd.y; if (Math.abs(dx) < 50) return; event.preventDefault(); if (dx > 0) { _this.stopTransitioning(); _this.next('default'); } else if (dx < 0) { _this.stopTransitioning(); _this.previous('default'); } }); this.$wrapper.addEventListener('touchend', function (event) { dragStart = null; dragEnd = null; }); } for (i = 0; i < this.images.length; i++) { if (this.preload) { this.$img = document.createElement('img'); this.$img.src = this.images[i].src; this.$img.addEventListener('load', function (event) { loaded++; }); } $slide = document.createElement('div'); $slide.style.backgroundImage = 'url(\'' + this.images[i].src + '\')'; $slide.style.backgroundPosition = this.images[i].position; $slide.style.backgroundRepeat = 'no-repeat'; $slide.style.backgroundSize = (this.preserveImageAspectRatio ? 'contain' : 'cover'); $slide.setAttribute('role', 'img'); $slide.setAttribute('aria-label', this.images[i].caption); this.$target.appendChild($slide); if (this.images[i].motion != 'none') { $slide.classList.add(this.images[i].motion); $slide.classList.add(this.speedClassName(this.images[i].speed)); } if ('linkUrl' in this.images[i]) { $slide.style.cursor = 'pointer'; $slide._linkUrl = this.images[i].linkUrl; hasLinks = true; } this.$slides.push($slide); } if (hasLinks) this.$target.addEventListener('click', function (event) { var slide; if (!('_linkUrl' in event.target)) return; slide = event.target; if ('onclick' in slide._linkUrl) { (slide._linkUrl.onclick)(event); return; } if ('href' in slide._linkUrl) { if (slide._linkUrl.href.charAt(0) == '#') { window.location.href = slide._linkUrl.href; return; } if ('target' in slide._linkUrl && slide._linkUrl.target == '_blank') window.open(slide._linkUrl.href); else window.location.href = slide._linkUrl.href; } }); switch (this.order) { case 'random': this.pos = (Math.ceil(Math.random() * this.$slides.length) - 1); break; case 'reverse': this.pos = this.$slides.length - 1; break; case 'default': default: this.pos = 0; break; }this.lastPos = this.pos; if (this.preload) intervalId = setInterval(function () { if (loaded >= _this.images.length) { clearInterval(intervalId); clearTimeout(_this.preloadTimeout); _this.$target.classList.remove('is-loading'); _this.start(); } }, 250); else { this.start(); } }; slideshowBackground.prototype.move = function (direction, activeOrder) { var pos, order; if (!activeOrder) activeOrder = this.order; switch (direction) { case 1: order = activeOrder; break; case -1: switch (activeOrder) { case 'random': order = 'random'; break; case 'reverse': order = 'default'; break; case 'default': default: order = 'reverse'; break; }break; default: return; }switch (order) { case 'random': for (; ;) { pos = (Math.ceil(Math.random() * this.$slides.length) - 1); if (pos != this.pos) break; } break; case 'reverse': pos = this.pos - 1; if (pos < 0) pos = this.$slides.length - 1; break; case 'default': default: pos = this.pos + 1; if (pos >= this.$slides.length) pos = 0; break; }this.show(pos); }; slideshowBackground.prototype.next = function (activeOrder) { this.move(1, activeOrder); }; slideshowBackground.prototype.previous = function (activeOrder) { this.move(-1, activeOrder); }; slideshowBackground.prototype.show = function (pos) { var _this = this; if (this.locked) return; this.lastPos = this.pos; this.pos = pos; switch (this.transition.style) { case 'instant': this.$slides[this.lastPos].classList.remove('top'); this.$slides[this.pos].classList.add('top'); this.$slides[this.pos].classList.add('visible'); this.$slides[this.pos].classList.add('is-playing'); this.$slides[this.lastPos].classList.remove('visible'); this.$slides[this.lastPos].classList.remove('initial'); this.$slides[this.lastPos].classList.remove('is-playing'); break; case 'crossfade': this.locked = true; this.$slides[this.lastPos].classList.remove('top'); this.$slides[this.pos].classList.add('top'); this.$slides[this.pos].classList.add('visible'); this.$slides[this.pos].classList.add('is-playing'); setTimeout(function () { _this.$slides[_this.lastPos].classList.remove('visible'); _this.$slides[_this.lastPos].classList.remove('initial'); _this.$slides[_this.lastPos].classList.remove('is-playing'); _this.locked = false; }, this.transition.speed); break; case 'fade': this.locked = true; this.$slides[this.lastPos].classList.remove('visible'); setTimeout(function () { _this.$slides[_this.lastPos].classList.remove('is-playing'); _this.$slides[_this.lastPos].classList.remove('top'); _this.$slides[_this.pos].classList.add('top'); _this.$slides[_this.pos].classList.add('is-playing'); _this.$slides[_this.pos].classList.add('visible'); _this.locked = false; }, this.transition.speed); break; default: break; } }; slideshowBackground.prototype.start = function () { var _this = this; this.$slides[_this.pos].classList.add('visible'); this.$slides[_this.pos].classList.add('top'); this.$slides[_this.pos].classList.add('initial'); this.$slides[_this.pos].classList.add('is-playing'); if (this.$slides.length == 1) return; setTimeout(function () { _this.startTransitioning(); }, this.wait); }; slideshowBackground.prototype.startTransitioning = function () { var _this = this; if (this.transition.delay === false) return; this.transitionInterval = setInterval(function () { _this.next(); }, this.transition.delay); }; slideshowBackground.prototype.stopTransitioning = function () { var _this = this; clearInterval(this.transitionInterval); if (this.transition.resume !== false) { clearTimeout(this.resumeTimeout); this.resumeTimeout = setTimeout(function () { _this.startTransitioning(); }, this.transition.resume); } }; (function () { new slideshowBackground('slideshow01', { target: '#slideshow01 .bg', wrapper: '#slideshow01 .content', wait: 0, defer: true, navigation: true, order: 'default', preserveImageAspectRatio: false, transition: { style: 'crossfade', speed: 500, delay: 4000, resume: 10000, }, images: [{ src: 'assets/images/slideshow01-dd318924.jpg?v=d795e2df', position: 'center', motion: 'none', speed: 2, caption: 'Untitled', }, { src: 'assets/images/slideshow01-99596dd3.jpg?v=d795e2df', position: 'center', motion: 'none', speed: 2, caption: 'Adapt to level geometry', }, { src: 'assets/images/slideshow01-a9980e1e.jpg?v=d795e2df', position: 'center', motion: 'none', speed: 2, caption: 'Untitled', }, { src: 'assets/images/slideshow01-7e3ace4a.jpg?v=d795e2df', position: 'center', motion: 'none', speed: 2, caption: 'Untitled', },] }); })(); ready.run(); })();</script>
</body>

</html>